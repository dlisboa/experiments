<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
  </head>
  <body>
    <template id="template-my-counter">
      <div>
        <bind onclick="updateResult" disabled="data-disabled" aria-label="my-label">
          <button type="button">
            <slot name="button-text"></slot>
          </button>
        </bind>
        <bind onclick="resetCounter">
          <button type="button">Reset</button>
        </bind>
        <div>
          Count:
          <bind data-foobar data-onclick>
            <span class="result-value">
              <slot name="result"></slot>
            </span>
          </bind>
          <p>
            <bind self="value"></bind>
          </p>
        </div>
      </div>
    </template>
    <script type="module">
      import { bind } from './bind3';

    const tmpl = document.getElementById("template-my-counter");

    class MyCounter extends HTMLElement {
      constructor() {
        super();
        this.count = 0;
        this.attachShadow({ mode: 'open' });
      }

      // Event handler methods
      updateResult(ev) {
        console.log('Button clicked:', ev.target);
        this.count++;
        this.updateDisplay();
      }

      resetCounter(ev) {
        console.log('Reset clicked:', ev.target)
        this.count = 0;
        this.updateDisplay();
      }

      onClick(ev) {
        console.log('onclick event', ev.target)
      }

      updateDisplay() {
        const resultSpan = this.shadowRoot.querySelector('.result-value slot');
        if (resultSpan) {
          // Update the slotted content
          const slottedResult = this.querySelector('[slot="result"]');
          if (slottedResult) {
            slottedResult.textContent = this.count;
          }
        }
      }

      connectedCallback() {
        this.render();
      }

      render() {
        // Clear previous content
        this.shadowRoot.innerHTML = '';

        // Use bind to create fragment with event listeners attached
        const fragment = bind(tmpl, this);
        this.shadowRoot.appendChild(fragment);
      }
    }

    // Define the custom element
    customElements.define('my-counter', MyCounter);
    </script>
    <my-counter data-foobar="true" my-label="this is the area label">
      <span slot="button-text" style="pointer-events: none">Click me</span>
      <span slot="result">inital result</span>
    </my-counter>
  </body>
</html>
